version: '2.4'

services:
    api:
        image: einstore/einstore-base:2.0
        volumes:
            - .:/app
        working_dir: /app
        restart: on-failure
        environment:
            APICORE_SERVER_NAME: BoostCore
            APICORE_DATABASE_HOST: postgres
            APICORE_DATABASE_USER: boost
            APICORE_DATABASE_PASSWORD: boost
            APICORE_DATABASE_DATABASE: boost
            APICORE_DATABASE_PORT: 5432
            APICORE_JWT_SECRET: secret
            APICORE_STORAGE_S3_ENABLED: 0
            APICORE_STORAGE_LOCAL_ROOT: /home/BoostCore
        depends_on:
            - postgres
        command: ["swift", "run", "--hostname", "0.0.0.0", "--port", "8080"]

    postgres:
        image: postgres:11-alpine
        restart: always
        environment:
            POSTGRES_USER: boost
            POSTGRES_PASSWORD: boost
            POSTGRES_DB: boost

    adminer:
        image: michalhosna/adminer:master
        environment:
            ADMINER_DB: boost
            ADMINER_DRIVER: pgsql
            ADMINER_PASSWORD: boost
            ADMINER_SERVER: postgres
            ADMINER_USERNAME: boost
            ADMINER_AUTOLOGIN: 1
            ADMINER_NAME: BoostCore
        depends_on:
            - postgres
